{"version":3,"sources":["webpack:///app/components/common/resultModal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6EA;;;;AACA;;;;AAEA;;kBAGA;AACA;AACA;AACA,0BADA;AAEA;AACA,wBADA;AAEA;AAFA,aAFA;AAMA;AANA;AAQA,KAVA;AAWA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aANA,EAMA,IANA,CAMA,MANA;;AAQA;AACA;;AAEA;AACA;AACA;AACA;AACA,4CAnBA,CAmBA;AACA;AACA,SAtBA;AAuBA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAHA;AAIA;;AAEA;AACA;AACA;;AAEA;AACA,SAtCA;AAuCA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AA9CA,KAXA;AA2DA;AACA;AACA;AACA;AACA,SAJA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAJA;AAKA;AAbA,KA3DA;AA0EA,2BACA,uBACA,mBADA,EAEA,oBAFA,EAGA,SAHA,EAIA,QAJA,EADA,CA1EA;AAkFA,WAlFA,qBAkFA;AACA;AACA;AACA,sDACA,CADA;AAEA,KAvFA;;AAwFA,aAxFA;AA2FA;AA3FA,C","file":"app/index.4457e6b01ed50c6d2a3e.hot-update.js","sourcesContent":["<template>\n    <div class=\"modal result-modal\" tabindex=\"-1\" role=\"dialog\">\n        <div class=\"modal-dialog modal-lg\" role=\"document\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                    <h5 class=\"modal-title\">\n                        <i class=\"fas fa-vote-yea\"></i>\n                        中獎名單\n                    </h5>\n                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                        <span aria-hidden=\"true\">&times;</span>\n                    </button>\n                </div>\n                <div class=\"modal-body\">\n                    <table class=\"table\">\n                        <thead>\n                            <tr>\n                                <th style=\"width: 15%;\">#</th>\n                                <th style=\"width: 30%;\">姓名</th>\n                                <th>獎項</th>\n                                <th style=\"width: 20%;\">功能</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <template v-for=\"(shortlist, shortlistIndex) in resultList\">\n                                <template v-if=\"shortlist.edit\">\n                                    <tr :key=\"shortlist.sn\" v-if=\"editsortList != null\">\n                                        <th scope=\"row\">\n                                            <select class=\"form-control\" v-model=\"editsortList.lucky\">\n                                                <option v-for=\"(luckyName, luckyValue) in luckyOption\" :value=\"luckyValue\">{{luckyName}}</option>\n                                            </select>\n                                        </th>\n                                        <td>{{editsortList.name}}</td>\n                                        <td >\n                                            <input class=\"form-control\" v-model=\"editsortList.award\">\n                                        </td>\n                                        <td>\n                                            <button class=\"btn btn-info\" v-on:click=\"save()\">\n                                                <i class=\"fas fa-save\"></i>\n                                            </button>\n                                            <button class=\"btn btn-warning\" v-on:click=\"openEdit(shortlistIndex, false)\">\n                                                <i class=\"fas fa-times\"></i>\n                                            </button>\n                                        </td>\n                                    </tr>\n                                </template>\n                                <template v-else>\n                                    <tr :key=\"shortlist.sn\">\n                                        <th scope=\"row\">\n                                            {{luckyOption[shortlist.lucky]}}\n                                        </th>\n                                        <td>{{shortlist.name}}</td>\n                                        <td >{{shortlist.award || \"--\"}}</td>\n                                        <td>\n                                            <button class=\"btn btn-success\" v-on:click=\"openEdit(shortlistIndex, true)\">\n                                                <i class=\"fas fa-edit\"></i>\n                                            </button>\n                                        </td>\n                                    </tr>\n                                </template>\n\n                            </template>\n                        </tbody>\n                    </table>\n                </div>\n                <div class=\"modal-footer\">\n                    <div class=\"col-6 text-left\">\n                    </div>\n                    <div class=\"col-6 text-right\">\n                        <button type=\"button\" class=\"btn btn-primary\" v-on:click=\"download\">下載</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n<script>\nimport Vue from 'vue';\nimport { mapActions, mapGetters } from 'vuex';\n\nlet targetDom = null;\n\n\nexport default {\n    data: function() {\n        return {\n            resultList: [],\n            luckyOption: {\n                0: \"未中獎\",\n                1: \"中獎\",\n            },\n            editsortList: null,\n        }\n    },\n    methods: {\n        download: function(){\n            const that = this;\n            let resultList = JSON.parse(JSON.stringify(that.resultList));\n\n            let cvs = \"姓名,職位,獎項\\n\" + resultList.map(function(Obj){\n                let data = [];\n                data.push( Obj.name );\n                data.push( Obj.pos );\n                data.push( Obj.award || \"--\" );\n                return data.join(\",\");\n            }).join(\"\\r\\n\");\n\n            let csvContent = \"data:text/csv;charset=utf-8,\" + cvs;\n            let encodedUri = encodeURI(csvContent);\n\n            let link = document.createElement(\"a\");\n            link.style.display = \"none\";\n            link.setAttribute(\"href\", encodedUri);\n            link.setAttribute(\"download\", that.config.webTitle + \"中獎名單.csv\");\n            document.body.appendChild(link); // Required for FF\n            link.click();\n        },\n        openEdit: function(index, editFlag){\n            const that = this;\n            let resultList = JSON.parse(JSON.stringify(that.resultList));\n\n            resultList = resultList.map(function(data){\n                data.edit = false;\n                return data;\n            });\n            resultList[index].edit = editFlag;\n\n            if (editFlag) {\n                that.editsortList = JSON.parse(JSON.stringify(resultList[index]));\n            }\n\n            that.resultList = resultList;\n        },\n        save: function(){\n            const that = this;\n            let editsortList = JSON.parse(JSON.stringify(that.editsortList));\n            const params = {\n                data: editsortList,\n            };\n            that.$store.dispatch(\"editShortList\", params);\n        },\n    },\n    watch: {\n        triggerOpenResult: function() {\n            const that = this;\n            targetDom.modal(\"show\");\n        },\n        shortlistByLuckySN: function(){\n            const that = this;\n            let shortlistByLuckySN = JSON.parse(JSON.stringify(that.shortlistByLuckySN));\n            that.resultList = shortlistByLuckySN.map(function(data){\n                data.lucky = that.luckySN.includes(data.sn)?1:0;\n                data.edit = false;\n                return data;\n            });\n        },\n    },\n    computed: {\n        ...mapGetters([\n            \"triggerOpenResult\",\n            \"shortlistByLuckySN\",\n            \"luckySN\",\n            \"config\",\n        ])\n    },\n    mounted() {\n        const that = this;\n        targetDom = $(that.$el);\n        targetDom.bind(\"shown.bs.modal\", function() {\n        });\n    },\n    props: {\n\n    },\n    components: {\n\n    }\n};\n</script>\n<style scoped>\n.modal-body{\n    height: calc( 100vh - 200px);\n    overflow: auto;\n}\n</style>"],"sourceRoot":""}