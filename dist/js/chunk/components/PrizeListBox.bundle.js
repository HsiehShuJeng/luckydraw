"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[431],{5470:(t,i,e)=>{e.r(i),e.d(i,{default:()=>d});var s=function(){var t=this,i=t._self._c;return i("div",{ref:"box",staticClass:"modal",attrs:{id:"PrizeListBox",tabindex:"-1",role:"dialog"}},[i("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[i("div",{staticClass:"modal-content"},[i("div",{staticClass:"modal-header"},[i("h5",{staticClass:"modal-title"},[i("i",{staticClass:"fas fa-award"}),t._v("\n                    獎項名單 ["+t._s(t.inputPrizeListCnt.cnt)+" / "+t._s(t.inputPrizeListCnt.amount)+"]\n                ")]),t._v(" "),t._m(0)]),t._v(" "),i("div",{staticClass:"modal-body"},[i("draggable",{attrs:{handle:".handler"},on:{change:t.sortCallback},model:{value:t.inputPrizeList,callback:function(i){t.inputPrizeList=i},expression:"inputPrizeList"}},[i("transition-group",[t._l(t.inputPrizeList,(function(e){return[!1===e.del?[t.editPrizeInfo&&t.editPrizeInfo.prize_sn===e.prize_sn?i("div",{key:e.prize_sn,staticClass:"input-group mb-3"},[i("div",{staticClass:"input-group-prepend handler cursor-pointer"},[i("span",{staticClass:"input-group-text",attrs:{id:"basic-addon1"}},[i("i",{staticClass:"fas fa-bars"})])]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.editPrizeInfo.title,expression:"editPrizeInfo.title"}],staticClass:"form-control",attrs:{type:"text",placeholder:"編輯獎項名稱"},domProps:{value:t.editPrizeInfo.title},on:{input:function(i){i.target.composing||t.$set(t.editPrizeInfo,"title",i.target.value)}}}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model.number",value:t.editPrizeInfo.amount,expression:"editPrizeInfo.amount",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",placeholder:"數量",min:"1",step:"1"},domProps:{value:t.editPrizeInfo.amount},on:{input:function(i){i.target.composing||t.$set(t.editPrizeInfo,"amount",t._n(i.target.value))},blur:function(i){return t.$forceUpdate()}}}),t._v(" "),i("div",{staticClass:"input-group-append"},[i("span",{staticClass:"input-group-text btn-success",staticStyle:{cursor:"pointer"},on:{click:t.saveEditPrizeAct}},[i("i",{staticClass:"far fa-save"})])])]):i("div",{key:e.prize_sn,staticClass:"input-group mb-3 prizeListGroup"},[i("div",{staticClass:"input-group-prepend handler cursor-pointer"},[i("span",{staticClass:"input-group-text",attrs:{id:"basic-addon1"}},[i("i",{staticClass:"fas fa-bars"})])]),t._v(" "),i("div",{staticClass:"form-control"},[t._v("\n                                        "+t._s(e.title)+" ("+t._s(e.amount)+")\n                                    ")]),t._v(" "),i("div",{staticClass:"input-group-append"},[i("span",{staticClass:"input-group-text",staticStyle:{cursor:"pointer"},on:{click:function(i){return t.openEditPrize(e)}}},[i("i",{staticClass:"far fa-edit"})])]),t._v(" "),i("div",{staticClass:"input-group-append"},[i("span",{staticClass:"input-group-text",staticStyle:{cursor:"pointer"},on:{click:function(i){return t.delPrizeAct(e)}}},[i("i",{staticClass:"fas fa-trash-alt"})])])])]:t._e()]}))],2)],1),t._v(" "),t.prizeList.length>0?[i("hr")]:t._e(),t._v(" "),t.addNewFlag?[i("div",{staticClass:"input-group mb-3",attrs:{id:"AddPrizeGroup"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.newPrize.title,expression:"newPrize.title"}],staticClass:"form-control",attrs:{name:"title",type:"text",placeholder:"新增的獎項名稱"},domProps:{value:t.newPrize.title},on:{input:function(i){i.target.composing||t.$set(t.newPrize,"title",i.target.value)}}}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model.number",value:t.newPrize.amount,expression:"newPrize.amount",modifiers:{number:!0}}],staticClass:"form-control",attrs:{name:"amount",type:"number",placeholder:"數量",min:"1",step:"1"},domProps:{value:t.newPrize.amount},on:{input:function(i){i.target.composing||t.$set(t.newPrize,"amount",t._n(i.target.value))},blur:function(i){return t.$forceUpdate()}}}),t._v(" "),i("div",{staticClass:"input-group-append"},[i("span",{staticClass:"input-group-text",staticStyle:{cursor:"pointer"},on:{click:t.saveNewPrizeAct}},[i("i",{staticClass:"far fa-save"})])])])]:[i("button",{staticClass:"btn btn-info btn-block",attrs:{id:"AddPrize",type:"button"},on:{click:function(i){return t.openAddPrize(!0)}}},[t._v("\n                        新增獎項\n                    ")])]],2)])])])};s._withStripped=!0;var n=e(7111),r=e.n(n),a=e(1551),o=e(1582),l=e(4651);const p={components:{draggable:r()},filters:{},props:{},data:()=>({addNewFlag:!1,newPrize:{title:"",amount:1},inputPrizeList:[],editPrizeInfo:null}),computed:{...(0,o.L8)(["triggerOpenPrizeList","prizeList"]),inputPrizeListCnt(){let t=0,i=0;return this.inputPrizeList.forEach((e=>{!1===e.del&&(t+=1,i+=e.amount)})),{cnt:t,amount:i}}},watch:{triggerOpenPrizeList:{handler(){this.triggerOpenPrizeList?l(this.$refs.box).modal("show"):l(this.$refs.box).modal("hide")}},inputPrizeList:{deep:!0,handler(){const t=this,i=JSON.stringify(t.prizeList),e=JSON.stringify(t.inputPrizeList);i!==e&&t.syncPrizeList(JSON.parse(e))}}},created(){},mounted(){const t=this;l(this.$refs.box).bind("shown.bs.modal",(()=>{t.inputPrizeList=JSON.parse(JSON.stringify(t.prizeList)),t.addNewFlag=!1,t.newPrize={title:"",amount:1},0===t.inputPrizeList.length&&(t.addNewFlag=!0),t.editPrizeInfo=null,a.Xe.mixpanel("PrizeListOpen_click"),a.Xe.gtag("event","PrizeListOpen_click")})),l(t.$refs.box).bind("hidden.bs.modal",(()=>{a.Xe.mixpanel("PrizeListClose_click"),a.Xe.gtag("event","PrizeListClose_click")})),this.triggerOpenPrizeList?l(this.$refs.box).modal("show"):l(this.$refs.box).modal("hide")},updated(){},destroyed(){},methods:{...(0,o.i0)({}),...(0,o.PY)({syncPrizeList:"syncPrizeList"}),openAddPrize(){this.newPrize={title:"",amount:1},this.addNewFlag=!0},saveNewPrizeAct(){const t=this;if(t.newPrize.title)if(JSON.parse(JSON.stringify(t.inputPrizeList)).map((t=>t.title)).includes(t.newPrize.title))a.lY.warning({html:"已有相同的獎項"});else{const i={prize_sn:a.Yj.getRandomString(10),title:"獎勵",amount:1,del:!1,...t.newPrize};t.inputPrizeList.push(i),t.addNewFlag=!1,a.Xe.mixpanel("PrizeListAdd_click",i),a.Xe.gtag("event","PrizeListAdd_click",i)}else t.addNewFlag=!1},openEditPrize(t){this.editPrizeInfo=JSON.parse(JSON.stringify(t))},saveEditPrizeAct(){const t=this;if(t.editPrizeInfo){const i=JSON.parse(JSON.stringify(t.editPrizeInfo)),e=JSON.parse(JSON.stringify(t.inputPrizeList));let s=!1;if(e.forEach((t=>{t.prize_sn!==i.prize_sn&&t.title===i.title&&(s=!0)})),s)a.lY.warning({html:"已有相同的獎項"});else{let s=!1;e.forEach(((t,e)=>{t.prize_sn===i.prize_sn&&(s=e)})),!1===s?(e.del=!1,e.push(i)):e[s]=i,t.inputPrizeList=e,a.Xe.mixpanel("PrizeListEditSave_click",i),a.Xe.gtag("event","PrizeListEditSave_click",i),t.editPrizeInfo=null}}},delPrizeAct(t){const i=this;a.lY.warning({html:"您確定要刪除此筆獎項嗎？對應的得獎資訊也都會消除唷"},(()=>{const e=JSON.parse(JSON.stringify(i.inputPrizeList));let s=!1;e.forEach(((i,e)=>{i.prize_sn===t.prize_sn&&(s=e)})),!1!==s&&(e[s].del=!0,a.Xe.mixpanel("PrizeListEditDel_click",e[s]),a.Xe.gtag("event","PrizeListEditDel_click",e[s])),i.inputPrizeList=e}))},sortCallback(){const t=JSON.parse(JSON.stringify(this.inputPrizeList));a.Xe.mixpanel("PrizeListSort_trigger",t),a.Xe.gtag("event","PrizeListSort_trigger",t)}}},d=(0,e(2881).A)(p,s,[function(){var t=this._self._c;return t("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[t("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])}],!1,null,"4e95f7e6",null).exports}}]);
//# sourceMappingURL=PrizeListBox.bundle.js.map?v=e1509f98067ed0384a2d